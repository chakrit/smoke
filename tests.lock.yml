- name: tests.yml \ Basics
  commands:
    - command: go build -o ./bin/smoke -v .
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
    - command: goimports -l *.go checks/*.go engine/*.go internal/p/*.go specs/*.go
      checks:
        - name: exitcode
          data:
            - "2"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - 'stat specs/*.go: no such file or directory'
    - command: ./bin/smoke
      checks:
        - name: exitcode
          data:
            - "1"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - requires a spec filename.
- name: tests.yml \ Unit Tests
  commands:
    - command: go test -v ./...
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - "?   \tgithub.com/chakrit/smoke\t[no test files]"
            - "?   \tgithub.com/chakrit/smoke/checks\t[no test files]"
            - "?   \tgithub.com/chakrit/smoke/engine\t[no test files]"
            - "?   \tgithub.com/chakrit/smoke/internal/p\t[no test files]"
            - "?   \tgithub.com/chakrit/smoke/resultspecs\t[no test files]"
            - "?   \tgithub.com/chakrit/smoke/testspecs\t[no test files]"
        - name: stderr
          data:
            - ""
- name: tests.yml \ Smoke Tests
  commands:
    - command: go build -o ./bin/smoke -v .
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - ""
    - command: ./bin/smoke --no-color --list tests.yml
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - tests.yml \ Basics
            - tests.yml \ Unit Tests
            - tests.yml \ Smoke Tests
            - tests.yml \ Diff Tests
            - tests.yml \ Errors
            - tests.yml \ Run Configs \ WorkDir
            - tests.yml \ Run Configs \ Env
        - name: stderr
          data:
            - ""
    - command: ./bin/smoke --no-color --list tests.yml -v
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - tests.yml \ Basics
            - "\tgo build -o ./bin/smoke -v ."
            - "\tgoimports -l *.go checks/*.go engine/*.go internal/p/*.go specs/*.go"
            - "\t./bin/smoke"
            - tests.yml \ Unit Tests
            - "\tgo test -v ./..."
            - tests.yml \ Smoke Tests
            - "\tgo build -o ./bin/smoke -v ."
            - "\t./bin/smoke --no-color --list tests.yml"
            - "\t./bin/smoke --no-color --list tests.yml -v"
            - tests.yml \ Diff Tests
            - "\t./bin/smoke --no-color badtests.yml"
            - tests.yml \ Errors
            - "\tunknowncommand_asdfqwerzcxv"
            - tests.yml \ Run Configs \ WorkDir
            - "\tls"
            - tests.yml \ Run Configs \ Env
            - "\techo $YEAS_ITS"
        - name: stderr
          data:
            - ""
- name: tests.yml \ Diff Tests
  commands:
    - command: ./bin/smoke --no-color badtests.yml
      checks:
        - name: exitcode
          data:
            - "1"
        - name: stdout
          data:
            - '    ==> badtests.yml \ lipsum'
            - '    --> head -22 badtests.txt | tail -5'
            - '        stdout'
            - '          hexagon. Chillwave you probably haven''t heard of them kale
              chips whatever selfies kombucha'
            - '---       live-edge kitsch meditation offal hella swag lo-fi. Air plant
              lo-fi green juice mumblecore'
            - '---       a bird on it. Ramps fanny pack humblebrag, leggings gochujang
              vexillologist echo park'
            - '          letterpress tbh pok pok. You probably haven''t heard of them
              kitsch chillwave wayfarers put'
            - +++       a bird on it. Ramps fanny pack humblebrag, leggings gochujang
              vexillologist echo park
            - +++       live-edge kitsch meditation offal hella swag lo-fi. Air plant
              lo-fi green juice mumblecore
            - '          mixtape bushwick leggings affogato portland la croix direct
              trade biodiesel DIY readymade'
            - '    --> tail -22 badtests.txt | head -5'
            - '        stdout'
            - '          wolf moon vice aesthetic hot chicken banjo gochujang succulents
              marfa vape mlkshk forage'
            - '---       chillwave. Farm-to-table venmo intelligentsia cred keytar,
              irony meditation raclette pok'
            - '---       before they sold out roof party normcore hammock. Mustache
              meh man braid, tbh pug raclette'
            - '          snackwave. Squid vaporware affogato, you probably haven''t
              heard of them snackwave raclette'
            - +++       before they sold out roof party normcore hammock. Mustache
              meh man braid, tbh pug raclette
            - +++       chillwave. Farm-to-table venmo intelligentsia cred keytar,
              irony meditation raclette pok
            - '          pok chartreuse everyday carry. Thundercats distillery organic
              scenester. Ugh tattooed'
            - ""
            - '  âœ˜ Changes Detected.'
        - name: stderr
          data:
            - ""
- name: tests.yml \ Errors
  commands:
    - command: unknowncommand_asdfqwerzcxv
      checks:
        - name: exitcode
          data:
            - "127"
        - name: stdout
          data:
            - ""
        - name: stderr
          data:
            - '/bin/sh: line 1: unknowncommand_asdfqwerzcxv: command not found'
- name: tests.yml \ Run Configs \ WorkDir
  commands:
    - command: ls
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - funcs.go
            - print.go
        - name: stderr
          data:
            - ""
- name: tests.yml \ Run Configs \ Env
  commands:
    - command: echo $YEAS_ITS
      checks:
        - name: exitcode
          data:
            - "0"
        - name: stdout
          data:
            - Working
        - name: stderr
          data:
            - ""
